<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
      integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z"
      crossorigin="anonymous"
    />
    <script
      src="https://kit.fontawesome.com/f909d114f1.js"
      crossorigin="anonymous"
    ></script>
    <link rel="stylesheet" href="/template.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css"
    />
  </head>
  <body>
    <nav class="navbar sticky-top navbar-expand-lg navbar-light bg-light">
      <a class="navbar-brand" href="#"> This is Jayesh </a>
      <button
        class="navbar-toggler"
        type="button"
        data-toggle="collapse"
        data-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent"
        aria-expanded="false"
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item">
            <a class="nav-link" href="#"
              ><i class="fas fa-palette fa-lg" onclick="openNav()"></i
            ></a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#"
              ><i class="fas fa-share-alt fa-lg"></i
            ></a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#"><i class="fas fa-eye fa-lg"></i></a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#"><i class="fas fa-user fa-lg"></i></a>
          </li>
        </ul>
      </div>
    </nav>
    <div id="mySidepanel" class="sidepanel">
      <ul class="nav flex-column">
        <li>
          Background - <input type="color" id="bgcolor" value="#3b8cb5" />
        </li>
        <li>sideline - <input type="color" id="color1" value="#3b8cb5" /></li>
        <li>
          Add Background Image
          <input type="file" id="image1" accept="image/*" />
        </li>
        <li>Text - <input type="color" id="color" /></li>
        <li>
          Font Size - <input type="number" value="16" min="10" id="fsize" />
        </li>
        <li>
          Font Family -
          <select name="font" id="ffamily">
            <option value="Arial" style="font-family: Arial">Arial</option>
            <option value="Algerian" style="font-family: Algerian">
              Algerian
            </option>
            <option
              value="Brush Script MT"
              style="font-family: Brush Script MT"
            >
              Brush Script MT
            </option>
            <option value="Calibri" style="font-family: Calibri">
              Calibri
            </option>
            <option value="Cambria" style="font-family: Cambria">
              Cambria
            </option>
            <option value="Copperplate" style="font-family: Copperplate">
              Copperplate
            </option>
            <option value="Didot" style="font-family: Didot">Didot</option>
            <option value="Garamond" style="font-family: Garamond">
              Garamond
            </option>
            <option value="Lucida Bright" style="font-family: Lucida Bright">
              Lucida Bright
            </option>
            <option value="Monaco" style="font-family: Monaco">Monaco</option>
            <option value="Optima" style="font-family: Optima">Optima</option>
            <option
              value="Times New Roman"
              style="font-family: Times New Roman"
            >
              Times New Roman
            </option>
          </select>
        </li>
        <li style="text-align: center">
          <button onclick="apply()" class="btn btn-primary">Apply</button>
        </li>
      </ul>
    </div>
    <div class="main">
      <div class="container">
        <div class="row" id="new" href="javascript:hello();">
          <div class="col-md-12 col-sm-6">
            <div class="card" style="height: auto">
              <div class="top"></div>
              <div class="card-body">
                <h1 class="card-title">Untitled Form</h1>
                <hr />
                <div class="file-field input-field">
                  <div class="btn">
                    <span>Logo File</span>
                    <input type="file" multiple />
                  </div>
                  <div class="file-path-wrapper">
                    <input
                      class="file-path validate"
                      type="text"
                      placeholder="Upload one or more files"
                    />
                  </div>
                </div>

                <p class="card-text">
                  Some quick example text to build on the card title and make up
                  the bulk of the card's content.
                </p>
                <input
                  placeholder="Form description"
                  type="text"
                  id="name"
                  required
                />
              </div>
            </div>
            <div class="card" style="height: auto">
              <div class="top"></div>
              <div class="card-body">
                <div class="row">
                  <input
                    style="width: 65%; margin-left: 40px; margin-top: 15px"
                    placeholder="Question"
                    type="text"
                    id="name1"
                    required
                  />
                  <input
                    style="width: 65%; margin-left: 40px; margin-top: 15px"
                    placeholder="Correct Answer"
                    type="text"
                    id="name2"
                    required
                  />
                  <div class="input-field col s12" style="width: 250px">
                    <select style="width: 160px" name="options" id="options">
                      <option value="text">Textbox</option>
                      <option value="radio">Radio</option>
                      <option value="checkbox">Checkbox</option>
                      <option value="email">Email</option>
                      <option value="textarea">TextArea</option>
                      <option value="datetime-local">Date & Time</option>
                    </select>
                  </div>
                </div>
                <div class="row">
                  <!-- <div class="file-field input-field">
                    <div class="btn">
                      <span>File</span>
                      <input type="file" multiple />
                    </div>
                    <div class="file-path-wrapper">
                      <input
                        class="file-path validate"
                        type="text"
                        placeholder="Upload one or more files"
                      />
                    </div>
                  </div> -->
                  <a
                    class="add btn-floating btn-large waves-effect waves-light blue"
                    onclick="addVal()"
                    ><i class="material-icons">+</i></a
                  >
                </div>
              </div>
            </div>
            <div id="contentItems"></div>
            <div class="btn-center">
              <button
                class="btn btn-success"
                onclick="submit(event)"
                data-user="<%=id%>"
              >
                <a
                  href="/data/<%=id%>"
                  style="text-decoration: none; color: aliceblue"
                  >Submit</a
                >
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script
      src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
      integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
      integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"
      integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV"
      crossorigin="anonymous"
    ></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <script src="/js/template1.js"></script>
    <script>
      var arr = [];
      var as = [];
      var obj;
      var s = "";
      var s2 = "";
      function addVal() {
        var x = document.getElementById("name1");
        var pqx = document.getElementById("name2");
        var s1,
          d = "Hello";
        var option = document.getElementById("options").value;
        obj = {
          question: x.value,
          answer: pqx.value,
          options: option,
          noOfItem: [],
        };
        arr.push(obj);
        printData();
      }
      function printData() {
        s1 = "";
        arr.map(function (item, index) {
          if (item.options == "radio" || item.options == "checkbox") {
            s +=
              "<div class='card'><div class='card-body'><hr/><p class='card-text'>" +
              item.question +
              "</p><p class='card-text'>Answer: " +
              item.answer +
              "</p><input type='radio'><p id='changes'></p><input placeholder='Form description' class=" +
              index +
              " style='width:200px;' type='text' id='name2' required/><a id=" +
              index +
              " class='add btn-floating btn-large waves-effect waves-light blue' onclick='addOption(this)'><i class='material-icons'>+</i></a><p>";
            if (item.noOfItem != []) {
              item.noOfItem.map(function (items, oindex) {
                s +=
                  "<input type='checkbox' style='margin-bottom:10px' checked='checked' " +
                  +"class=" +
                  index +
                  "></input>" +
                  items +
                  "<button value=" +
                  oindex +
                  " id=" +
                  index +
                  " class='btn btn-sm btn-danger' style='margin-left:15px;margin-bottom:10px;' onclick='deleteItem(this)'><i class='fas fa-trash'></i></button><br>";
              });
            }
            s +=
              "</p></div><button id=" +
              index +
              " class='btn btn-danger' onclick='deleteOption(this)'>Remove</button></div>";
          } else if (item.options == "text") {
            s +=
              "<div class='card'><div class='card-body'><hr/><p class='card-text'>" +
              item.question +
              "</p><input placeholder='Form description' type='text' id='name2' required/></div><button id=" +
              index +
              " class='btn btn-danger' onclick='deleteOption(this)'>Remove</button></div>";
          } else if (item.options == "textarea") {
            s +=
              "<div class='card'><div class='card-body'><hr/><p class='card-text'>" +
              item.question +
              "</p><textarea rows='5' id=" +
              index +
              "></textarea></div><button id=" +
              index +
              " class='btn btn-danger' onclick='deleteOption(this)'>Remove</button></div>";
          } else if (item.options == "email") {
            s +=
              "<div class='card'><div class='card-body'><hr/><p class='card-text'>" +
              item.question +
              "</p><input placeholder='Form description' type='email' id='name2' required/></div><button id=" +
              index +
              " class='btn btn-danger' onclick='deleteOption(this)'>Remove</button></div>";
          } else {
            s +=
              "<div class='card'><div class='card-body'><hr/><input placeholder='Form description' type=" +
              item.options +
              " id='name2' required/></div><button id=" +
              index +
              " class='btn btn-danger' onclick='deleteOption(this)'>Remove</button></div>";
          }
          document.getElementById("contentItems").innerHTML = s;
        });
        s = "";
      }
      function addOption(e) {
        // var p = document.getElementById("changes");
        // var ad = document.getElementById("name2").value;
        // as.push(ad);
        // as.map(function (item, index) {
        //   s2 += "<p id='changes'>" + item + "</p>";
        //   p.innerHTML = s2;
        // });
        // s2 = "";
        console.log(e);
        arr[e.id].noOfItem.push(document.getElementsByClassName(e.id)[0].value);
        console.log(arr[e.id]);
        printData();
        //   p.innerHTML = ad;
      }
      function deleteItem(e) {
        arr[e.id].noOfItem.splice(e.value, 1);
        printData();
      }
      function deleteOption(e) {
        console.log(e);
        arr.splice(e.id, 1);
        console.log(arr);
        printData();
      }
      function openNav() {
        var x = document.getElementById("mySidepanel");
        if (x.style.display === "none") {
          x.style.display = "block";
          x.style.width = "22vw";
        } else {
          x.style.width = "0";
          x.style.display = "none";
        }
      }
      function apply() {
        document.querySelector("body").style.color = document.getElementById(
          "color"
        ).value;
        document.querySelector(
          ".top"
        ).style.backgroundColor = document.getElementById("color1").value;
        document.querySelector(".main").style.fontSize =
          document.getElementById("fsize").value + "px";
        document.querySelector(
          ".main"
        ).style.fontFamily = document.getElementById("ffamily").value;

        if (document.getElementById("image1").value == "") {
          document.querySelector("body").style.backgroundImage = "url()";
          document.querySelector(
            "body"
          ).style.backgroundColor = document.getElementById("bgcolor").value;
        } else {
          document.querySelector("body").style.backgroundColor = "#3b8cb5";
          document.querySelector("body").style.backgroundImage =
            "url(document.getElementById('image1').value)";
        }
        printData();
      }
      function submit(event) {
        var linke = event.target.dataset.user;

        try {
          const res = fetch("/compose/" + linke, {
            method: "POST",
            body: JSON.stringify(arr),
            headers: { "Content-Type": "application/json" },
          });
          //const data = res.json();

          //   location.assign("/data/" + linke);
          // changew this later to new page
        } catch (err) {
          console.log(err);
        }
      }
    </script>
  </body>
</html>
